CREATE COMPUTE MODULE FieldFunction_Flow_Compute
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN
		-- CALL CopyMessageHeaders();
		CALL CopyEntireMessage();
		RETURN TRUE;
	END;

	CREATE PROCEDURE CopyMessageHeaders() BEGIN
		DECLARE I INTEGER 1;
		DECLARE J INTEGER;
		SET J = CARDINALITY(InputRoot.*[]);
		WHILE I < J DO
			SET OutputRoot.*[I] = InputRoot.*[I];
			SET I = I + 1;
		END WHILE;
	END;

	CREATE PROCEDURE CopyEntireMessage() BEGIN
		--General 
--		DECLARE inref REFERENCE TO InputRoot.XMLNSC.Person;
--		SET OutputRoot.XMLNSC.result.Tag = FIELDNAME(inref.*[<]);
--		SET OutputRoot.XMLNSC.result.Val = FIELDVALUE(inref.*[<]);
		
		
		-- Actual Input
		DECLARE inref1 REFERENCE TO InputRoot.XMLNSC.Root.Order;
		CREATE LASTCHILD OF OutputRoot.JSON.Data.id[1] NAME FIELDNAME(inref1.OrderID) VALUE FIELDVALUE(inref1.OrderID);
		
		DECLARE inref1 REFERENCE TO InputRoot.XMLNSC.Root.Order.Customer;
		
	END;
END MODULE;

--<Root>
--    <Order>
--        <OrderID>12345</OrderID>
--        <Customer>
--            <CustomerID>54321</CustomerID>
--            <Name>John Doe</Name>
--            <Address>
--                <Street>Main St</Street>
--                <City>Anytown</City>
--                <State>CA</State>
--                <Zip>12345</Zip>
--            </Address>
--        </Customer>
--        <Items>
--            <Item>
--                <ProductID>001</ProductID>
--                <ProductName>Widget</ProductName>
--                <Quantity>10</Quantity>
--                <Price>19.99</Price>
--            </Item>
--            <Item>
--                <ProductID>002</ProductID>
--                <ProductName>Gadget</ProductName>
--                <Quantity>5</Quantity>
--                <Price>29.99</Price>
--            </Item>
--        </Items>
--    </Order>
--    <Payment>
--        <Method>Credit Card</Method>
--        <Amount>299.85</Amount>
--    </Payment>
--</Root>